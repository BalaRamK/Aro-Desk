(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[486],{73360:(e,t,r)=>{Promise.resolve().then(r.bind(r,36e3))},36e3:(e,t,r)=>{"use strict";r.d(t,{JourneyKanbanClient:()=>j});var a=r(95155),s=r(12115),n=r(91812),l=r(53561),d=r(66889),c=r(86878);function i(e){let{id:t,title:r,count:s,targetDays:l,avgDays:i,color:o,children:x}=e,{setNodeRef:m,isOver:u}=(0,n.zM)({id:t});return(0,a.jsxs)("div",{ref:m,className:"flex-shrink-0 w-80 bg-white dark:bg-slate-800 rounded-lg border-2 transition-all ".concat(u?"border-blue-500 shadow-lg":"border-slate-200 dark:border-slate-700"),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",style:{borderTopColor:o,borderTopWidth:"4px",borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:r}),(0,a.jsx)("span",{className:"text-sm font-medium text-slate-500",children:s})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-600 dark:text-slate-400",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(d.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:["Target: ",l,"d"]})]}),null!==i&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(c.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:["Avg: ",Math.round(i),"d"]})]})]})]}),(0,a.jsxs)("div",{className:"p-2 space-y-2 min-h-[200px] max-h-[calc(100vh-300px)] overflow-y-auto",children:[x,0===s&&(0,a.jsx)("div",{className:"flex items-center justify-center h-32 text-sm text-slate-400",children:"No accounts in this stage"})]})]})}var o=r(66329),x=r(35007),m=r(39286),u=r(27530),f=r(14807),h=r(48173),g=r.n(h);function p(e){let{id:t,name:r,arr:s,healthScore:n,riskLevel:d,csmName:c}=e,{attributes:i,listeners:h,setNodeRef:p,transform:v,transition:b,isDragging:N}=(0,l.gl)({id:t}),j={transform:o.Ks.Transform.toString(v),transition:b,opacity:N?.5:1};return(0,a.jsx)("div",{ref:p,style:j,children:(0,a.jsx)(x.Zp,{className:"p-3 hover:shadow-md transition-shadow cursor-pointer",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("button",{className:"mt-1 cursor-grab active:cursor-grabbing text-slate-400 hover:text-slate-600",...i,...h,children:(0,a.jsx)(u.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)(g(),{href:"/dashboard/accounts/".concat(t),className:"block hover:text-blue-600",children:(0,a.jsx)("h4",{className:"font-semibold text-sm text-slate-900 dark:text-slate-100 truncate",children:r})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(f.A,{className:"h-3 w-3 text-slate-400"}),(0,a.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:s?"$".concat(parseInt(s).toLocaleString()):"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(n>=70?"bg-green-500":n>=40?"bg-yellow-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:n})]}),(0,a.jsx)(m.E,{variant:"Critical"===d?"destructive":"High"===d?"default":"secondary",className:"text-xs",children:d})]}),(0,a.jsxs)("div",{className:"text-xs text-slate-500 mt-2 truncate",children:["CSM: ",c||"Unassigned"]})]})]})})})}var v=r(75828);let b=(0,v.createServerReference)("70d502ab1ee2046d48b5b61eec9c7acffedf7bbd95",v.callServer,void 0,v.findSourceMapURL,"updateAccountStage");var N=r(76046);function j(e){let{stages:t,accounts:r}=e,[d,c]=(0,s.useState)(r),o=(0,N.useRouter)(),x=(0,n.FR)((0,n.MS)(n.AN),(0,n.MS)(n.uN,{coordinateGetter:l.JR}));async function m(e){let{active:t,over:r}=e;if(!r)return;let a=d.find(e=>e.id===t.id);if(!a)return;let s=r.id;if(a.current_stage!==s){c(e=>e.map(e=>e.id===a.id?{...e,current_stage:s}:e));try{await b(a.id,s,"Moved from ".concat(a.current_stage," to ").concat(s," via Kanban")),o.refresh()}catch(e){console.error("Failed to update account stage:",e),c(e=>e.map(e=>e.id===a.id?{...e,current_stage:a.current_stage}:e))}}}return(0,a.jsx)(n.Mp,{sensors:x,collisionDetection:n.fp,onDragEnd:m,children:(0,a.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4",children:t.map(e=>{let t=d.filter(t=>t.current_stage===e.name);return(0,a.jsx)(i,{id:e.name,title:e.name,count:t.length,targetDays:e.target_duration_days,avgDays:e.avg_duration_days,color:e.color_hex,children:(0,a.jsx)(l.gB,{items:t.map(e=>e.id),strategy:l._G,children:t.map(e=>(0,a.jsx)(p,{id:e.id,name:e.name,arr:e.arr,healthScore:e.overall_score,riskLevel:e.risk_level,csmName:e.csm_name},e.id))})},e.id)})})})}},39286:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var a=r(95155);r(12115);var s=r(31027),n=r(29602);let l=(0,s.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:r}),t),...s})}},35007:(e,t,r)=>{"use strict";r.d(t,{BT:()=>i,Wu:()=>o,ZB:()=>c,Zp:()=>l,aR:()=>d,wL:()=>x});var a=r(95155),s=r(12115),n=r(29602);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});l.displayName="Card";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});d.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});i.displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});o.displayName="CardContent";let x=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})});x.displayName="CardFooter"},29602:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(43463),s=r(69795);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[181,173,313,441,517,358],()=>t(73360)),_N_E=e.O()}]);