(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[486],{4340:(e,t,r)=>{"use strict";r.d(t,{JourneyKanbanClient:()=>j});var s=r(95155),a=r(12115),n=r(17787),l=r(49027),d=r(26983),c=r(1524);function i(e){let{id:t,title:r,count:a,targetDays:l,avgDays:i,color:o,children:x}=e,{setNodeRef:m,isOver:u}=(0,n.zM)({id:t});return(0,s.jsxs)("div",{ref:m,className:"flex-shrink-0 w-80 bg-white dark:bg-slate-800 rounded-lg border-2 transition-all ".concat(u?"border-blue-500 shadow-lg":"border-slate-200 dark:border-slate-700"),children:[(0,s.jsxs)("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",style:{borderTopColor:o,borderTopWidth:"4px",borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:r}),(0,s.jsx)("span",{className:"text-sm font-medium text-slate-500",children:a})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-600 dark:text-slate-400",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(d.A,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Target: ",l,"d"]})]}),null!==i&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(c.A,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Avg: ",Math.round(i),"d"]})]})]})]}),(0,s.jsxs)("div",{className:"p-2 space-y-2 min-h-[200px] max-h-[calc(100vh-300px)] overflow-y-auto",children:[x,0===a&&(0,s.jsx)("div",{className:"flex items-center justify-center h-32 text-sm text-slate-400",children:"No accounts in this stage"})]})]})}var o=r(27587),x=r(83209),m=r(67812),u=r(49476),f=r(91761),h=r(52619),g=r.n(h);function p(e){let{id:t,name:r,arr:a,healthScore:n,riskLevel:d,csmName:c}=e,{attributes:i,listeners:h,setNodeRef:p,transform:v,transition:b,isDragging:N}=(0,l.gl)({id:t}),j={transform:o.Ks.Transform.toString(v),transition:b,opacity:N?.5:1};return(0,s.jsx)("div",{ref:p,style:j,children:(0,s.jsx)(x.Zp,{className:"p-3 hover:shadow-md transition-shadow cursor-pointer",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)("button",{className:"mt-1 cursor-grab active:cursor-grabbing text-slate-400 hover:text-slate-600",...i,...h,children:(0,s.jsx)(u.A,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(g(),{href:"/dashboard/accounts/".concat(t),className:"block hover:text-blue-600",children:(0,s.jsx)("h4",{className:"font-semibold text-sm text-slate-900 dark:text-slate-100 truncate",children:r})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,s.jsx)(f.A,{className:"h-3 w-3 text-slate-400"}),(0,s.jsx)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:a?"$".concat(parseInt(a).toLocaleString()):"N/A"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(n>=70?"bg-green-500":n>=40?"bg-yellow-500":"bg-red-500")}),(0,s.jsx)("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:n})]}),(0,s.jsx)(m.E,{variant:"Critical"===d?"destructive":"High"===d?"default":"secondary",className:"text-xs",children:d})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-500 mt-2 truncate",children:["CSM: ",c||"Unassigned"]})]})]})})})}var v=r(30926);let b=(0,v.createServerReference)("70b54de73cc768597933a251865628f27c19fddd19",v.callServer,void 0,v.findSourceMapURL,"updateAccountStage");var N=r(20063);function j(e){let{stages:t,accounts:r}=e,[d,c]=(0,a.useState)(r),o=(0,N.useRouter)(),x=(0,n.FR)((0,n.MS)(n.AN),(0,n.MS)(n.uN,{coordinateGetter:l.JR}));async function m(e){let{active:t,over:r}=e;if(!r)return;let s=d.find(e=>e.id===t.id);if(!s)return;let a=r.id;if(s.current_stage!==a){c(e=>e.map(e=>e.id===s.id?{...e,current_stage:a}:e));try{await b(s.id,a,"Moved from ".concat(s.current_stage," to ").concat(a," via Kanban")),o.refresh()}catch(e){console.error("Failed to update account stage:",e),c(e=>e.map(e=>e.id===s.id?{...e,current_stage:s.current_stage}:e))}}}return(0,s.jsx)(n.Mp,{sensors:x,collisionDetection:n.fp,onDragEnd:m,children:(0,s.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4",children:t.map(e=>{var t,r;let a=null!=(t=e.stage)?t:e.name,n=d.filter(e=>e.current_stage===a);return(0,s.jsx)(i,{id:a,title:null!=(r=e.name)?r:a,count:n.length,targetDays:e.target_duration_days,avgDays:e.avg_duration_days,color:e.color_hex,children:(0,s.jsx)(l.gB,{items:n.map(e=>e.id),strategy:l._G,children:n.map(e=>(0,s.jsx)(p,{id:e.id,name:e.name,arr:e.arr,healthScore:e.overall_score,riskLevel:e.risk_level,csmName:e.csm_name},e.id))})},e.id)})})})}},25016:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(2821),a=r(75889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},67812:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var s=r(95155);r(12115);var a=r(83101),n=r(25016);let l=(0,a.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(l({variant:r}),t),...a})}},83209:(e,t,r)=>{"use strict";r.d(t,{BT:()=>i,Wu:()=>o,ZB:()=>c,Zp:()=>l,aR:()=>d,wL:()=>x});var s=r(95155),a=r(12115),n=r(25016);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...a})});l.displayName="Card";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});d.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",r),...a})});c.displayName="CardTitle";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});i.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});o.displayName="CardContent";let x=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})});x.displayName="CardFooter"},87816:(e,t,r)=>{Promise.resolve().then(r.bind(r,4340))}},e=>{e.O(0,[909,619,377,441,255,358],()=>e(e.s=87816)),_N_E=e.O()}]);