exports.id=803,exports.ids=[803],exports.modules={7629:(a,b,c)=>{"use strict";c.d(b,{p:()=>g});var d=c(21124),e=c(38301),f=c(15514);let g=e.forwardRef(({className:a,type:b,...c},e)=>(0,d.jsx)("input",{type:b,className:(0,f.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));g.displayName="Input"},15514:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f});var d=c(43249),e=c(58829);function f(...a){return(0,e.QP)((0,d.$)(a))}},16953:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>h,metadata:()=>g});var d=c(75338),e=c(42003),f=c.n(e);c(82704);let g={title:"Customer Success Platform",description:"Multi-tenant Customer Success Platform with RLS"};function h({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsx)("body",{className:f().className,children:a})})}},19217:(a,b,c)=>{"use strict";c.d(b,{$:()=>j});var d=c(21124),e=c(38301),f=c(96425),g=c(26691),h=c(15514);let i=(0,g.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),j=e.forwardRef(({className:a,variant:b,size:c,asChild:e=!1,...g},j)=>{let k=e?f.DX:"button";return(0,d.jsx)(k,{className:(0,h.cn)(i({variant:b,size:c,className:a})),ref:j,...g})});j.displayName="Button"},20847:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{"00144cf6654d6ec1e8cd64cbed3894d48e549ec871":()=>e.VM,"006ffebcc94bd590a30dc9eba8d78bce7f67358af1":()=>e.Ht,"00dd6164ca3750410eeab95c47d13d1c31d06a5f65":()=>e.Kd,"40880c5c97236d745490c2dfdc64edb9096b9468f3":()=>e.Lz,"40b0704a9b0fe78e21bfbfb1380e804abea90646e7":()=>e.zP,"40d082e2f235ea4ba7ebb0544b77b0c34f5a65e2e1":()=>e.RX});var e=c(65010),f=a([e]);e=(f.then?(await f)():f)[0],d()}catch(a){d(a)}})},45119:(a,b,c)=>{"use strict";c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h,wL:()=>l});var d=c(21124),e=c(38301),f=c(15514);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...b}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("font-semibold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-muted-foreground",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b}));l.displayName="CardFooter"},52273:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},53199:(a,b,c)=>{"use strict";c.d(b,{J:()=>j});var d=c(21124),e=c(38301),f=c(46029),g=c(26691),h=c(15514);let i=(0,g.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.b,{ref:c,className:(0,h.cn)(i(),a),...b}));j.displayName=f.b.displayName},62001:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},65010:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Ht:()=>r,Kd:()=>u,Lz:()=>t,RX:()=>s,VM:()=>v,zP:()=>q});var e=c(91488);c(27806);var f=c(88480),g=c(70495),h=c(69206),i=c(91837),j=c(24727),k=c.n(j),l=c(56602),m=c(87438),n=c(40410),o=a([f]);f=(o.then?(await o)():o)[0];let w=new TextEncoder().encode(process.env.SESSION_SECRET||"local-dev-secret-change-in-production");async function p(a,b){return await new l.P({sub:a,email:b}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(w)}async function q(a){try{return(await (0,m.V)(a,w)).payload}catch(a){return null}}async function r(){let a=await (0,g.UL)(),b=a.get("session")?.value;if(!b)return null;let c=await q(b);if(!c)return null;let d=await (0,f.KU)();try{await d.query(`SET LOCAL app.current_user_id = '${c.sub}'`);let a=await d.query(`SELECT u.id, u.email, p.tenant_id, p.role, p.full_name, p.is_active
       FROM users u
       JOIN profiles p ON u.id = p.id
       WHERE u.id = $1`,[c.sub]);if(0===a.rows.length)return null;return{user:a.rows[0],userId:c.sub,email:c.email}}finally{d.release()}}async function s(a){let b=await (0,f.KU)();try{if(await b.query("BEGIN"),(await b.query("SELECT id FROM users WHERE email = $1",[a.email])).rows.length>0)return{error:"User with this email already exists"};let c=await k().hash(a.password,10),d=(await b.query(`INSERT INTO users (email, encrypted_password, email_confirmed_at)
       VALUES ($1, $2, NOW())
       RETURNING id`,[a.email,c])).rows[0].id,e=null;if(a.inviteToken)return{error:"Invite functionality not yet implemented"};let f=a.organizationName.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");e=(await b.query(`INSERT INTO tenants (name, slug, is_active)
       VALUES ($1, $2, true)
       RETURNING id`,[`${a.organizationName}`,`${f}-${Date.now()}`])).rows[0].id,await b.query(`INSERT INTO profiles (id, tenant_id, role, full_name, is_active)
       VALUES ($1, $2, $3, $4, true)`,[d,e,"Tenant Admin",a.fullName]),await b.query("COMMIT");let h=await p(d,a.email);return(await (0,g.UL)()).set("session",h,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"}),(0,i.revalidatePath)("/","layout"),{success:!0}}catch(a){return await b.query("ROLLBACK"),console.error("Signup error:",a),{error:a.message||"An unexpected error occurred during signup"}}finally{b.release()}}async function t(a){let b=await (0,f.KU)();try{let c=await b.query(`SELECT u.id, u.email, u.encrypted_password, p.tenant_id, p.role, p.is_active
       FROM users u
       JOIN profiles p ON u.id = p.id
       WHERE u.email = $1`,[a.email]);if(0===c.rows.length)return{error:"Invalid email or password"};let d=c.rows[0];if(!await k().compare(a.password,d.encrypted_password))return{error:"Invalid email or password"};if(!d.is_active)return{error:"Your account has been deactivated. Please contact your administrator."};let e=await p(d.id,d.email);return(await (0,g.UL)()).set("session",e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"}),(0,i.revalidatePath)("/","layout"),{success:!0}}catch(a){return console.error("Signin error:",a),{error:"An unexpected error occurred during signin"}}finally{b.release()}}async function u(){(await (0,g.UL)()).delete("session"),(0,i.revalidatePath)("/","layout"),(0,h.redirect)("/login")}async function v(){let a=await r();if(!a)return null;let b=await (0,f.KU)();try{await b.query(`SET LOCAL app.current_user_id = '${a.userId}'`);let c=await b.query(`SELECT p.*, t.name as tenant_name, t.slug as tenant_slug
       FROM profiles p
       JOIN tenants t ON p.tenant_id = t.id
       WHERE p.id = $1`,[a.userId]);if(0===c.rows.length)return null;return{...c.rows[0],tenant:{id:c.rows[0].tenant_id,name:c.rows[0].tenant_name,slug:c.rows[0].tenant_slug}}}finally{b.release()}}(0,n.D)([q,r,s,t,u,v]),(0,e.A)(q,"40b0704a9b0fe78e21bfbfb1380e804abea90646e7",null),(0,e.A)(r,"006ffebcc94bd590a30dc9eba8d78bce7f67358af1",null),(0,e.A)(s,"40d082e2f235ea4ba7ebb0544b77b0c34f5a65e2e1",null),(0,e.A)(t,"40880c5c97236d745490c2dfdc64edb9096b9468f3",null),(0,e.A)(u,"00dd6164ca3750410eeab95c47d13d1c31d06a5f65",null),(0,e.A)(v,"00144cf6654d6ec1e8cd64cbed3894d48e549ec871",null),d()}catch(a){d(a)}})},78321:()=>{},78993:()=>{},82704:()=>{},88480:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Fh:()=>i,KU:()=>h,P:()=>g});var e=c(64939),f=a([e]);let j=new(e=(f.then?(await f)():f)[0]).Pool({connectionString:process.env.DATABASE_URL,max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3});async function g(a,b){let c=Date.now();try{let d=await j.query(a,b),e=Date.now()-c;return console.log("Executed query",{text:a,duration:e,rows:d.rowCount}),d}catch(a){throw console.error("Database query error:",a),a}}async function h(){return j.connect()}async function i(a,b){let c=`SET LOCAL app.current_user_id = '${a}'`;b?await b.query(c):await g(c)}d()}catch(a){d(a)}})}};