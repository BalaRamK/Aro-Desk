(()=>{var e={};e.id=349,e.ids=[349],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},33873:e=>{"use strict";e.exports=require("path")},64939:e=>{"use strict";e.exports=import("pg")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},65483:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>c.a,__next_app__:()=>u,pages:()=>l,routeModule:()=>f,tree:()=>d});var r=a(70260),s=a(28203),n=a(25155),c=a.n(n),i=a(67292),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(t,o);let d=["",{children:["dashboard",{children:["integrations",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,26593)),"/Volumes/Extreme SSD/Aro Desk/app/dashboard/integrations/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,83748)),"/Volumes/Extreme SSD/Aro Desk/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,19611)),"/Volumes/Extreme SSD/Aro Desk/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,41485,23)),"next/dist/client/components/unauthorized-error"]}],l=["/Volumes/Extreme SSD/Aro Desk/app/dashboard/integrations/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/dashboard/integrations/page",pathname:"/dashboard/integrations",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},36464:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{"0004aa8566c1f3e312cb7f3e3813d6157b8fb58a8b":()=>s.VM,"005425e0a812709ce540c323e485343a1ac42fce8e":()=>n.Q1,"007c7f942aadb8dbc8cc2b6b30f60982431f70127f":()=>s.Kd,"009a4985819b97b4be2fe1cdb32c9df11877379ad4":()=>s.Ht,"00c51daf9dff5a256b21999797c4e988b3e5114375":()=>n.HB,"00dc1677d24c5ceadcc7273a31ef52a63def6788d0":()=>n.mf,"402950729f574cd9671c0cabe09d6b2f7bc109631e":()=>n.P4,"402d0d22c145eada57fb25e0c590e564864c8c79b2":()=>n.qO,"404277a33f7cb0ce1f7247add59deea9a766c2d7db":()=>s.Lz,"40982a859ec3c46a1b6607285e686490468d9e8108":()=>s.zP,"40a26f5e0a796fc4965d4d28aa51508a107d704968":()=>n.xP,"40ac348b21dd335ce9d63d26c1939b25abc541f965":()=>n.yW,"40b79742bcbf00dfdf85e2af52cbbed0924121a839":()=>n.ND,"40bd541fc16e4b03c33c1297531f2e89d59c364b4e":()=>s.RX,"40d355824c03bd8e1cb0730e5dd1e86a630707aa5b":()=>n.hd,"608c42a796b1bf12ec0a4ee124c2f68213455f2758":()=>n.o2,"70d502ab1ee2046d48b5b61eec9c7acffedf7bbd95":()=>n.N9});var s=a(35603),n=a(13311),c=e([s,n]);[s,n]=c.then?(await c)():c,r()}catch(e){r(e)}})},14449:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{"005d5417e6fd1ab8e17ca3c58882bac84a8a640fd5":()=>s.Rv,"00c44463ca850d014edd9c4dc327e8abc3e2449d56":()=>s.k2,"4006b32074cd353399841e8981ef268ea1411511f0":()=>s.nf,"4007194b52fdc9dd77b3eb5e60faf0b592c042ff63":()=>s.i0,"400e9bdc8f9030c353320a36bbe358e7547acbd65a":()=>s.gz,"40126e94ecb3ce5386d931575028fc7a9f1bdb7e0d":()=>s.qS,"401469c06835afa4c2dbc43e6a5a762cb501c80a7b":()=>s.$g,"401cbeebb3a77284c7e08634fea588e9eca00c63c9":()=>s.Y8,"60172f8f0165c5d99c426d4d3cc4f3cc7ef071487c":()=>s.ZP,"60a8c6878f1bd3776201c9cd2f3cb75ddda5465724":()=>s.rW,"60e11222f2dfcf9f7cb586928c6d8d6d083f0a8f6d":()=>s.IF});var s=a(91261),n=e([s]);s=(n.then?(await n)():n)[0],r()}catch(e){r(e)}})},53238:(e,t,a)=>{Promise.resolve().then(a.bind(a,97069))},93150:(e,t,a)=>{Promise.resolve().then(a.bind(a,6985))},6985:(e,t,a)=>{"use strict";a.d(t,{default:()=>M});var r=a(45512),s=a(58009),n=a(97643),c=a(87021),i=a(77252),o=a(41680);let d=(0,o.A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var l=a(80832);let u=(0,o.A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),f=(0,o.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),h=(0,o.A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var p=a(4643),m=a(94520),x=a(49656),y=a(18741),g=a(26248);let b=(0,g.createServerReference)("005d5417e6fd1ab8e17ca3c58882bac84a8a640fd5",g.callServer,void 0,g.findSourceMapURL,"getIntegrationSources"),_=(0,g.createServerReference)("00c44463ca850d014edd9c4dc327e8abc3e2449d56",g.callServer,void 0,g.findSourceMapURL,"getIntegrationStats"),v=(0,g.createServerReference)("4006b32074cd353399841e8981ef268ea1411511f0",g.callServer,void 0,g.findSourceMapURL,"deleteIntegrationSource"),w=(0,g.createServerReference)("400e9bdc8f9030c353320a36bbe358e7547acbd65a",g.callServer,void 0,g.findSourceMapURL,"triggerSync"),j=(0,g.createServerReference)("60172f8f0165c5d99c426d4d3cc4f3cc7ef071487c",g.callServer,void 0,g.findSourceMapURL,"getSyncLogs");var N=a(71965),E=a(25409),R=a(47699),k=a(54069),S=a(48859);let C=(0,g.createServerReference)("40126e94ecb3ce5386d931575028fc7a9f1bdb7e0d",g.callServer,void 0,g.findSourceMapURL,"createIntegrationSource");var T=a(59462);let D=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,T.cn)("w-full caption-bottom text-sm",e),...t})}));D.displayName="Table";let A=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("thead",{ref:a,className:(0,T.cn)("[&_tr]:border-b",e),...t}));A.displayName="TableHeader";let P=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("tbody",{ref:a,className:(0,T.cn)("[&_tr:last-child]:border-0",e),...t}));P.displayName="TableBody",s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("tfoot",{ref:a,className:(0,T.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let I=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("tr",{ref:a,className:(0,T.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));I.displayName="TableRow";let L=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("th",{ref:a,className:(0,T.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));L.displayName="TableHead";let $=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("td",{ref:a,className:(0,T.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));$.displayName="TableCell",s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("caption",{ref:a,className:(0,T.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption";var O=a(79334);let F={jira:"\uD83C\uDFAF",zoho_crm:"\uD83D\uDCCA",zoho_desk:"\uD83C\uDFAB",salesforce:"☁️",hubspot:"\uD83D\uDFE0",zendesk:"\uD83D\uDCAC",intercom:"\uD83D\uDCAC",slack:"\uD83D\uDCAC",custom:"\uD83D\uDD0C"};function M(){let[e,t]=(0,s.useState)([]),[a,o]=(0,s.useState)(null),[y,g]=(0,s.useState)(!0),[E,R]=(0,s.useState)(null),[k,S]=(0,s.useState)([]);(0,O.useRouter)();let C=async()=>{try{let[e,a]=await Promise.all([b(),_()]);t(e),o(a)}catch(e){console.error("Error loading integrations:",e),alert("Failed to load integrations")}finally{g(!1)}},T=async e=>{if(confirm("Are you sure you want to delete this integration?"))try{await v(e),alert("Integration deleted successfully"),C()}catch(e){alert("Failed to delete integration")}},M=async e=>{try{await w(e),alert("Sync triggered successfully"),setTimeout(C,1e3)}catch(e){alert("Failed to trigger sync")}},U=async e=>{R(e);try{let t=await j(e.id);S(t)}catch(e){alert("Failed to load sync logs")}};return y?(0,r.jsx)("div",{children:"Loading integrations..."}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Total Integrations"}),(0,r.jsx)(d,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:a?.total_integrations||0}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[a?.active_integrations||0," active"]})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Synced Records"}),(0,r.jsx)(l.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:a?.total_synced_records||0}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[a?.contacts||0," contacts, ",a?.tickets||0," tickets, ",a?.deals||0," deals"]})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Last 24h Syncs"}),(0,r.jsx)(u,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:a?.last_24h_syncs||0}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Automatic and manual"})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-sm font-medium",children:"Failed Syncs"}),(0,r.jsx)(f,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:a?.failed_syncs||0}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last 7 days"})]})]})]}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsx)(n.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.ZB,{children:"Connected Integrations"}),(0,r.jsx)(n.BT,{children:"Manage your external data sources"})]}),(0,r.jsx)(W,{onSuccess:C})]})}),(0,r.jsx)(n.Wu,{children:0===e.length?(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(d,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,r.jsx)("p",{children:"No integrations configured yet"}),(0,r.jsx)("p",{className:"text-sm",children:'Click "Add Integration" to connect your first data source'})]}):(0,r.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-accent/50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"text-3xl",children:F[e.source_type]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h3",{className:"font-semibold",children:e.name}),(0,r.jsx)(i.E,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"}),e.last_sync_status&&(0,r.jsxs)(i.E,{variant:"success"===e.last_sync_status?"default":"failed"===e.last_sync_status?"destructive":"secondary",children:["success"===e.last_sync_status&&(0,r.jsx)(h,{className:"h-3 w-3 mr-1"}),"failed"===e.last_sync_status&&(0,r.jsx)(f,{className:"h-3 w-3 mr-1"}),"pending"===e.last_sync_status&&(0,r.jsx)(p.A,{className:"h-3 w-3 mr-1"}),e.last_sync_status]})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description||`${e.source_type} integration`}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-xs text-muted-foreground",children:[e.last_sync_at&&(0,r.jsxs)("span",{children:["Last sync: ",new Date(e.last_sync_at).toLocaleString()]}),(0,r.jsxs)("span",{children:[e.sync_count," total syncs"]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>M(e.id),children:[(0,r.jsx)(u,{className:"h-4 w-4 mr-1"}),"Sync Now"]}),(0,r.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>U(e),children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-1"}),"Logs"]}),(0,r.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>T(e.id),children:(0,r.jsx)(x.A,{className:"h-4 w-4 text-destructive"})})]})]},e.id))})})]}),E&&(0,r.jsx)(N.lG,{open:!!E,onOpenChange:()=>R(null),children:(0,r.jsxs)(N.Cf,{className:"max-w-4xl",children:[(0,r.jsxs)(N.c7,{children:[(0,r.jsxs)(N.L3,{children:["Sync Logs - ",E.name]}),(0,r.jsx)(N.rr,{children:"Recent synchronization history"})]}),(0,r.jsx)("div",{className:"max-h-[500px] overflow-y-auto",children:(0,r.jsxs)(D,{children:[(0,r.jsx)(A,{children:(0,r.jsxs)(I,{children:[(0,r.jsx)(L,{children:"Started"}),(0,r.jsx)(L,{children:"Duration"}),(0,r.jsx)(L,{children:"Status"}),(0,r.jsx)(L,{children:"Records"}),(0,r.jsx)(L,{children:"Triggered By"})]})}),(0,r.jsx)(P,{children:k.map(e=>(0,r.jsxs)(I,{children:[(0,r.jsx)($,{className:"text-sm",children:new Date(e.sync_started_at).toLocaleString()}),(0,r.jsx)($,{children:e.duration_ms?`${(e.duration_ms/1e3).toFixed(2)}s`:"-"}),(0,r.jsx)($,{children:(0,r.jsx)(i.E,{variant:"success"===e.status?"default":"failed"===e.status?"destructive":(e.status,"secondary"),children:e.status})}),(0,r.jsx)($,{className:"text-sm",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("span",{children:["✅ ",e.records_created," created"]}),(0,r.jsxs)("span",{children:["\uD83D\uDD04 ",e.records_updated," updated"]}),e.records_failed>0&&(0,r.jsxs)("span",{className:"text-destructive",children:["❌ ",e.records_failed," failed"]})]})}),(0,r.jsx)($,{className:"text-sm capitalize",children:e.triggered_by})]},e.id))})]})})]})})]})}function W({onSuccess:e}){let[t,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)({source_type:"zoho_crm",name:"",description:"",n8n_webhook_url:"",api_url:"",api_key:""}),o=async t=>{t.preventDefault();try{await C({source_type:n.source_type,name:n.name,description:n.description,n8n_webhook_url:n.n8n_webhook_url,config:{api_url:n.api_url,api_key:n.api_key}}),alert("Integration created successfully"),a(!1),i({source_type:"zoho_crm",name:"",description:"",n8n_webhook_url:"",api_url:"",api_key:""}),e()}catch(e){alert("Failed to create integration")}};return(0,r.jsxs)(N.lG,{open:t,onOpenChange:a,children:[(0,r.jsx)(N.zM,{asChild:!0,children:(0,r.jsxs)(c.$,{children:[(0,r.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Add Integration"]})}),(0,r.jsxs)(N.Cf,{className:"max-w-2xl",children:[(0,r.jsxs)(N.c7,{children:[(0,r.jsx)(N.L3,{children:"Add New Integration"}),(0,r.jsx)(N.rr,{children:"Connect a new external data source to sync data automatically"})]}),(0,r.jsxs)("form",{onSubmit:o,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(R.J,{htmlFor:"source_type",children:"Integration Type"}),(0,r.jsxs)(k.l6,{value:n.source_type,onValueChange:e=>i({...n,source_type:e}),children:[(0,r.jsx)(k.bq,{children:(0,r.jsx)(k.yv,{})}),(0,r.jsxs)(k.gC,{children:[(0,r.jsx)(k.eb,{value:"jira",children:"\uD83C\uDFAF Jira"}),(0,r.jsx)(k.eb,{value:"zoho_crm",children:"\uD83D\uDCCA Zoho CRM"}),(0,r.jsx)(k.eb,{value:"zoho_desk",children:"\uD83C\uDFAB Zoho Desk"}),(0,r.jsx)(k.eb,{value:"salesforce",children:"☁️ Salesforce"}),(0,r.jsx)(k.eb,{value:"hubspot",children:"\uD83D\uDFE0 HubSpot"}),(0,r.jsx)(k.eb,{value:"zendesk",children:"\uD83D\uDCAC Zendesk"}),(0,r.jsx)(k.eb,{value:"intercom",children:"\uD83D\uDCAC Intercom"}),(0,r.jsx)(k.eb,{value:"slack",children:"\uD83D\uDCAC Slack"}),(0,r.jsx)(k.eb,{value:"custom",children:"\uD83D\uDD0C Custom API"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(R.J,{htmlFor:"name",children:"Integration Name"}),(0,r.jsx)(E.p,{id:"name",placeholder:"e.g., Zoho CRM Production",value:n.name,onChange:e=>i({...n,name:e.target.value}),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(R.J,{htmlFor:"description",children:"Description (Optional)"}),(0,r.jsx)(S.T,{id:"description",placeholder:"Describe what data this integration syncs",value:n.description,onChange:e=>i({...n,description:e.target.value}),rows:2})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(R.J,{htmlFor:"n8n_webhook_url",children:"n8n Webhook URL"}),(0,r.jsx)(E.p,{id:"n8n_webhook_url",placeholder:"http://localhost:5678/webhook/zoho-crm-sync",value:n.n8n_webhook_url,onChange:e=>i({...n,n8n_webhook_url:e.target.value}),required:!0}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"The webhook URL from your n8n workflow that will handle the sync"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(R.J,{htmlFor:"api_url",children:"API URL (Optional)"}),(0,r.jsx)(E.p,{id:"api_url",placeholder:"https://api.zoho.com/crm/v2",value:n.api_url,onChange:e=>i({...n,api_url:e.target.value})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(R.J,{htmlFor:"api_key",children:"API Key (Optional)"}),(0,r.jsx)(E.p,{id:"api_key",type:"password",placeholder:"Your API key or token",value:n.api_key,onChange:e=>i({...n,api_key:e.target.value})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(c.$,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,r.jsx)(c.$,{type:"submit",children:"Create Integration"})]})]})]})]})}},77252:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var r=a(45512);a(58009);var s=a(21643),n=a(59462);let c=(0,s.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:t,...a}){return(0,r.jsx)("div",{className:(0,n.cn)(c({variant:t}),e),...a})}},87021:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(45512),s=a(58009),n=a(12705),c=a(21643),i=a(59462);let o=(0,c.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef(({className:e,variant:t,size:a,asChild:s=!1,...c},d)=>{let l=s?n.DX:"button";return(0,r.jsx)(l,{className:(0,i.cn)(o({variant:t,size:a,className:e})),ref:d,...c})});d.displayName="Button"},97643:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>l,ZB:()=>o,Zp:()=>c,aR:()=>i,wL:()=>u});var r=a(45512),s=a(58009),n=a(59462);let c=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("div",{ref:a,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...t}));c.displayName="Card";let i=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let o=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("h3",{ref:a,className:(0,n.cn)("font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let d=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("p",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let l=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("div",{ref:a,className:(0,n.cn)("p-6 pt-0",e),...t}));l.displayName="CardContent";let u=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},25409:(e,t,a)=>{"use strict";a.d(t,{p:()=>c});var r=a(45512),s=a(58009),n=a(59462);let c=s.forwardRef(({className:e,type:t,...a},s)=>(0,r.jsx)("input",{type:t,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...a}));c.displayName="Input"},47699:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var r=a(45512),s=a(58009),n=a(92405),c=a(21643),i=a(59462);let o=(0,c.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.b,{ref:a,className:(0,i.cn)(o(),e),...t}));d.displayName=n.b.displayName},54069:(e,t,a)=>{"use strict";a.d(t,{bq:()=>f,eb:()=>x,gC:()=>m,l6:()=>l,yv:()=>u});var r=a(45512),s=a(58009),n=a(59039),c=a(98755),i=a(28638),o=a(24849),d=a(59462);let l=n.bL;n.YJ;let u=n.WT,f=s.forwardRef(({className:e,children:t,...a},s)=>(0,r.jsxs)(n.l9,{ref:s,className:(0,d.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[t,(0,r.jsx)(n.In,{asChild:!0,children:(0,r.jsx)(c.A,{className:"h-4 w-4 opacity-50"})})]}));f.displayName=n.l9.displayName;let h=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.PP,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,r.jsx)(i.A,{className:"h-4 w-4"})}));h.displayName=n.PP.displayName;let p=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.wn,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,r.jsx)(c.A,{className:"h-4 w-4"})}));p.displayName=n.wn.displayName;let m=s.forwardRef(({className:e,children:t,position:a="popper",...s},c)=>(0,r.jsx)(n.ZL,{children:(0,r.jsxs)(n.UC,{ref:c,className:(0,d.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...s,children:[(0,r.jsx)(h,{}),(0,r.jsx)(n.LM,{className:(0,d.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,r.jsx)(p,{})]})}));m.displayName=n.UC.displayName,s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.JU,{ref:a,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",e),...t})).displayName=n.JU.displayName;let x=s.forwardRef(({className:e,children:t,...a},s)=>(0,r.jsxs)(n.q7,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.VF,{children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(n.p4,{children:t})]}));x.displayName=n.q7.displayName,s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.wv,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=n.wv.displayName},48859:(e,t,a)=>{"use strict";a.d(t,{T:()=>c});var r=a(45512),s=a(58009),n=a(59462);let c=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...t}));c.displayName="Textarea"},4643:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(41680).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},80832:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(41680).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},91261:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{$g:()=>g,IF:()=>x,Rv:()=>d,Y8:()=>y,ZP:()=>m,gz:()=>p,i0:()=>b,k2:()=>l,nf:()=>h,qS:()=>u,rW:()=>f});var s=a(21590);a(70376);var n=a(75190),c=a(47735),i=a(99344),o=e([n]);async function d(){try{return(await (0,n.P)(`SELECT 
        id, tenant_id, source_type, name, description, 
        config, n8n_workflow_id, n8n_webhook_url, 
        is_active, last_sync_at, last_sync_status, last_sync_error,
        sync_count, created_at, updated_at
       FROM integration_sources
       ORDER BY created_at DESC`)).rows}catch(e){throw console.error("Error fetching integration sources:",e),e}}async function l(){try{let e=await (0,n.P)(`
      SELECT 
        COUNT(*) FILTER (WHERE source_type IS NOT NULL) as total_integrations,
        COUNT(*) FILTER (WHERE is_active = true) as active_integrations
      FROM integration_sources
    `),t=await (0,n.P)(`
      SELECT 
        COUNT(*) as total_synced_records,
        COUNT(*) FILTER (WHERE internal_table = 'external_contacts') as contacts,
        COUNT(*) FILTER (WHERE internal_table = 'external_tickets') as tickets,
        COUNT(*) FILTER (WHERE internal_table = 'external_deals') as deals
      FROM integration_synced_records
      WHERE sync_status = 'synced'
    `),a=await (0,n.P)(`
      SELECT 
        COUNT(*) FILTER (WHERE sync_started_at > NOW() - INTERVAL '24 hours') as last_24h_syncs,
        COUNT(*) FILTER (WHERE status = 'failed' AND sync_started_at > NOW() - INTERVAL '7 days') as failed_syncs
      FROM integration_sync_logs
    `);return{total_integrations:parseInt(e.rows[0]?.total_integrations||"0"),active_integrations:parseInt(e.rows[0]?.active_integrations||"0"),total_synced_records:parseInt(t.rows[0]?.total_synced_records||"0"),contacts:parseInt(t.rows[0]?.contacts||"0"),tickets:parseInt(t.rows[0]?.tickets||"0"),deals:parseInt(t.rows[0]?.deals||"0"),last_24h_syncs:parseInt(a.rows[0]?.last_24h_syncs||"0"),failed_syncs:parseInt(a.rows[0]?.failed_syncs||"0")}}catch(e){return console.error("Error fetching integration stats:",e),{total_integrations:0,active_integrations:0,total_synced_records:0,contacts:0,tickets:0,deals:0,last_24h_syncs:0,failed_syncs:0}}}async function u(e){try{let t=await (0,n.P)(`INSERT INTO integration_sources 
       (source_type, name, description, config, n8n_workflow_id, n8n_webhook_url, tenant_id)
       VALUES ($1, $2, $3, $4, $5, $6, requesting_tenant_id())
       RETURNING *`,[e.source_type,e.name,e.description,JSON.stringify(e.config),e.n8n_workflow_id,e.n8n_webhook_url]);return(0,c.revalidatePath)("/dashboard/integrations"),t.rows[0]}catch(e){throw console.error("Error creating integration source:",e),e}}async function f(e,t){try{let a=[],r=[],s=1;void 0!==t.name&&(a.push(`name = $${s++}`),r.push(t.name)),void 0!==t.description&&(a.push(`description = $${s++}`),r.push(t.description)),void 0!==t.config&&(a.push(`config = $${s++}`),r.push(JSON.stringify(t.config))),void 0!==t.n8n_workflow_id&&(a.push(`n8n_workflow_id = $${s++}`),r.push(t.n8n_workflow_id)),void 0!==t.n8n_webhook_url&&(a.push(`n8n_webhook_url = $${s++}`),r.push(t.n8n_webhook_url)),void 0!==t.is_active&&(a.push(`is_active = $${s++}`),r.push(t.is_active)),r.push(e);let i=await (0,n.P)(`UPDATE integration_sources 
       SET ${a.join(", ")}, updated_at = NOW()
       WHERE id = $${s}
       RETURNING *`,r);return(0,c.revalidatePath)("/dashboard/integrations"),i.rows[0]}catch(e){throw console.error("Error updating integration source:",e),e}}async function h(e){try{return await (0,n.P)("DELETE FROM integration_sources WHERE id = $1",[e]),(0,c.revalidatePath)("/dashboard/integrations"),{success:!0}}catch(e){throw console.error("Error deleting integration source:",e),e}}async function p(e){try{let t=await (0,n.P)(`INSERT INTO integration_sync_logs 
       (integration_source_id, status, triggered_by)
       VALUES ($1, 'running', 'manual')
       RETURNING id`,[e]),a=await (0,n.P)("SELECT n8n_webhook_url FROM integration_sources WHERE id = $1",[e]);if(a.rows[0]?.n8n_webhook_url)try{let e=await fetch(a.rows[0].n8n_webhook_url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trigger:"manual",sync_log_id:t.rows[0].id})});if(!e.ok)throw Error(`n8n webhook failed: ${e.statusText}`)}catch(e){throw await (0,n.P)(`UPDATE integration_sync_logs 
           SET status = 'failed', 
               error_message = $1,
               sync_completed_at = NOW(),
               duration_ms = EXTRACT(EPOCH FROM (NOW() - sync_started_at)) * 1000
           WHERE id = $2`,[String(e),t.rows[0].id]),e}return(0,c.revalidatePath)("/dashboard/integrations"),{success:!0,sync_log_id:t.rows[0].id}}catch(e){throw console.error("Error triggering sync:",e),e}}async function m(e,t=10){try{return(await (0,n.P)(`SELECT 
        id, sync_started_at, sync_completed_at, status,
        records_processed, records_created, records_updated, records_failed,
        error_message, triggered_by, duration_ms
       FROM integration_sync_logs
       WHERE integration_source_id = $1
       ORDER BY sync_started_at DESC
       LIMIT $2`,[e,t])).rows}catch(e){throw console.error("Error fetching sync logs:",e),e}}async function x(e,t){try{let a="",r=[];return"contacts"===e?(a=`
        SELECT 
          id, external_id, source_type, 
          first_name, last_name, email, phone, title,
          properties, last_synced_at
        FROM external_contacts
        ${t?"WHERE account_id = $1":""}
        ORDER BY last_synced_at DESC
      `,t&&(r=[t])):"tickets"===e?(a=`
        SELECT 
          id, external_id, source_type, title, status, priority,
          reporter_email, created_date, resolved_date,
          properties, last_synced_at
        FROM external_tickets
        ${t?"WHERE account_id = $1":""}
        ORDER BY created_date DESC
      `,t&&(r=[t])):"deals"===e&&(a=`
        SELECT 
          id, external_id, source_type, name, amount, stage,
          close_date, owner_email,
          properties, last_synced_at
        FROM external_deals
        ${t?"WHERE account_id = $1":""}
        ORDER BY created_date DESC
      `,t&&(r=[t])),(await (0,n.P)(a,r)).rows}catch(e){throw console.error("Error fetching external data:",e),e}}async function y(e){try{return(await (0,n.P)(`SELECT 
        id, source_field, target_table, target_field,
        transformation_rule, is_required, default_value
       FROM integration_field_mappings
       WHERE integration_source_id = $1
       ORDER BY target_table, target_field`,[e])).rows}catch(e){throw console.error("Error fetching field mappings:",e),e}}async function g(e){try{let t=await (0,n.P)(`INSERT INTO integration_field_mappings 
       (integration_source_id, source_field, target_table, target_field, 
        transformation_rule, is_required, default_value)
       VALUES ($1, $2, $3, $4, $5, $6, $7)
       RETURNING *`,[e.integration_source_id,e.source_field,e.target_table,e.target_field,JSON.stringify(e.transformation_rule||{}),e.is_required||!1,e.default_value]);return(0,c.revalidatePath)("/dashboard/integrations"),t.rows[0]}catch(e){throw console.error("Error creating field mapping:",e),e}}async function b(e){try{return await (0,n.P)("DELETE FROM integration_field_mappings WHERE id = $1",[e]),(0,c.revalidatePath)("/dashboard/integrations"),{success:!0}}catch(e){throw console.error("Error deleting field mapping:",e),e}}n=(o.then?(await o)():o)[0],(0,i.D)([d,l,u,f,h,p,m,x,y,g,b]),(0,s.A)(d,"005d5417e6fd1ab8e17ca3c58882bac84a8a640fd5",null),(0,s.A)(l,"00c44463ca850d014edd9c4dc327e8abc3e2449d56",null),(0,s.A)(u,"40126e94ecb3ce5386d931575028fc7a9f1bdb7e0d",null),(0,s.A)(f,"60a8c6878f1bd3776201c9cd2f3cb75ddda5465724",null),(0,s.A)(h,"4006b32074cd353399841e8981ef268ea1411511f0",null),(0,s.A)(p,"400e9bdc8f9030c353320a36bbe358e7547acbd65a",null),(0,s.A)(m,"60172f8f0165c5d99c426d4d3cc4f3cc7ef071487c",null),(0,s.A)(x,"60e11222f2dfcf9f7cb586928c6d8d6d083f0a8f6d",null),(0,s.A)(y,"401cbeebb3a77284c7e08634fea588e9eca00c63c9",null),(0,s.A)(g,"401469c06835afa4c2dbc43e6a5a762cb501c80a7b",null),(0,s.A)(b,"4007194b52fdc9dd77b3eb5e60faf0b592c042ff63",null),r()}catch(e){r(e)}})},97069:(e,t,a)=>{"use strict";a.d(t,{default:()=>r});let r=(0,a(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Volumes/Extreme SSD/Aro Desk/app/dashboard/integrations/integrations-content.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Volumes/Extreme SSD/Aro Desk/app/dashboard/integrations/integrations-content.tsx","default")},26593:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i,metadata:()=>c});var r=a(62740),s=a(76301),n=a(97069);let c={title:"Integrations | Customer Success Platform",description:"Connect external data sources like Jira, Zoho CRM, and more"};function i(){return(0,r.jsxs)("div",{className:"flex-1 space-y-4 p-4 md:p-8 pt-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between space-y-2",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Integrations"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Connect external data sources to sync contacts, tickets, and deals"})]})}),(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading..."}),children:(0,r.jsx)(n.default,{})})]})}},75190:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{KU:()=>i,P:()=>c});var s=a(64939),n=e([s]);let o=new(s=(n.then?(await n)():n)[0]).Pool({connectionString:process.env.DATABASE_URL,max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3});async function c(e,t){let a=Date.now();try{let r=await o.query(e,t),s=Date.now()-a;return console.log("Executed query",{text:e,duration:s,rows:r.rowCount}),r}catch(e){throw console.error("Database query error:",e),e}}async function i(){return o.connect()}r()}catch(e){r(e)}})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638,720,145,464,101,461,226],()=>a(65483));module.exports=r})();