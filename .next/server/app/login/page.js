(()=>{var e={};e.id=520,e.ids=[520],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},33873:e=>{"use strict";e.exports=require("path")},64939:e=>{"use strict";e.exports=import("pg")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},9175:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=t(70260),s=t(28203),n=t(25155),i=t.n(n),o=t(67292),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,43642)),"/Volumes/Extreme SSD/Aro Desk/app/login/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,19611)),"/Volumes/Extreme SSD/Aro Desk/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],c=["/Volumes/Extreme SSD/Aro Desk/app/login/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},60229:(e,r,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{"0004aa8566c1f3e312cb7f3e3813d6157b8fb58a8b":()=>s.VM,"007c7f942aadb8dbc8cc2b6b30f60982431f70127f":()=>s.Kd,"009a4985819b97b4be2fe1cdb32c9df11877379ad4":()=>s.Ht,"404277a33f7cb0ce1f7247add59deea9a766c2d7db":()=>s.Lz,"40982a859ec3c46a1b6607285e686490468d9e8108":()=>s.zP,"40bd541fc16e4b03c33c1297531f2e89d59c364b4e":()=>s.RX});var s=t(5916),n=e([s]);s=(n.then?(await n)():n)[0],a()}catch(e){a(e)}})},74578:(e,r,t)=>{Promise.resolve().then(t.bind(t,43642))},21434:(e,r,t)=>{Promise.resolve().then(t.bind(t,17825))},82952:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,13219,23)),Promise.resolve().then(t.t.bind(t,34863,23)),Promise.resolve().then(t.t.bind(t,25155,23)),Promise.resolve().then(t.t.bind(t,40802,23)),Promise.resolve().then(t.t.bind(t,9350,23)),Promise.resolve().then(t.t.bind(t,48530,23)),Promise.resolve().then(t.t.bind(t,88921,23))},46504:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,66959,23)),Promise.resolve().then(t.t.bind(t,33875,23)),Promise.resolve().then(t.t.bind(t,88903,23)),Promise.resolve().then(t.t.bind(t,57174,23)),Promise.resolve().then(t.t.bind(t,84178,23)),Promise.resolve().then(t.t.bind(t,87190,23)),Promise.resolve().then(t.t.bind(t,61365,23))},5939:()=>{},363:()=>{},17825:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var a=t(45512),s=t(58009),n=t(79334),i=t(28531),o=t.n(i),l=t(6868),d=t(81914),c=t(45009),u=t(87021),p=t(25409),m=t(47699),f=t(97643),x=t(26248);let b=(0,x.createServerReference)("404277a33f7cb0ce1f7247add59deea9a766c2d7db",x.callServer,void 0,x.findSourceMapURL,"signInAction"),h=c.Ik({email:c.Yj().email("Invalid email address"),password:c.Yj().min(6,"Password must be at least 6 characters")});function g(){let e=(0,n.useRouter)(),[r,t]=(0,s.useState)(!1),[i,c]=(0,s.useState)(null),{register:x,handleSubmit:g,formState:{errors:w}}=(0,l.mN)({resolver:(0,d.u)(h)}),y=async r=>{t(!0),c(null);try{let a=await b({email:r.email,password:r.password});if(a.error){c(a.error),t(!1);return}e.push("/dashboard"),e.refresh()}catch(e){c("An unexpected error occurred. Please try again."),t(!1)}};return(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-4",children:(0,a.jsxs)(f.Zp,{className:"w-full max-w-md",children:[(0,a.jsxs)(f.aR,{className:"space-y-1",children:[(0,a.jsx)(f.ZB,{className:"text-2xl font-bold text-center",children:"Welcome Back"}),(0,a.jsx)(f.BT,{className:"text-center",children:"Sign in to your Customer Success Platform account"})]}),(0,a.jsxs)("form",{onSubmit:g(y),suppressHydrationWarning:!0,children:[(0,a.jsxs)(f.Wu,{className:"space-y-4",children:[i&&(0,a.jsx)("div",{className:"p-3 text-sm text-red-500 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-md",suppressHydrationWarning:!0,children:i}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"email",children:"Email"}),(0,a.jsx)(p.p,{id:"email",type:"email",placeholder:"you@example.com",autoComplete:"email",disabled:r,...x("email")}),w.email&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:w.email.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(m.J,{htmlFor:"password",children:"Password"}),(0,a.jsx)(o(),{href:"/forgot-password",className:"text-xs text-primary hover:underline",children:"Forgot password?"})]}),(0,a.jsx)(p.p,{id:"password",type:"password",autoComplete:"current-password",disabled:r,...x("password")}),w.password&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:w.password.message})]})]}),(0,a.jsxs)(f.wL,{className:"flex flex-col space-y-4",children:[(0,a.jsx)(u.$,{type:"submit",className:"w-full",disabled:r,children:r?"Signing in...":"Sign In"}),(0,a.jsxs)("div",{className:"text-sm text-center text-muted-foreground",children:["Don't have an account?"," ",(0,a.jsx)(o(),{href:"/signup",className:"text-primary font-medium hover:underline",children:"Sign up"})]})]})]})]})})}},87021:(e,r,t)=>{"use strict";t.d(r,{$:()=>d});var a=t(45512),s=t(58009),n=t(12705),i=t(21643),o=t(59462);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef(({className:e,variant:r,size:t,asChild:s=!1,...i},d)=>{let c=s?n.DX:"button";return(0,a.jsx)(c,{className:(0,o.cn)(l({variant:r,size:t,className:e})),ref:d,...i})});d.displayName="Button"},97643:(e,r,t)=>{"use strict";t.d(r,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>i,aR:()=>o,wL:()=>u});var a=t(45512),s=t(58009),n=t(59462);let i=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...r}));i.displayName="Card";let o=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...r}));o.displayName="CardHeader";let l=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let d=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...r}));d.displayName="CardDescription";let c=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent";let u=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...r}));u.displayName="CardFooter"},25409:(e,r,t)=>{"use strict";t.d(r,{p:()=>i});var a=t(45512),s=t(58009),n=t(59462);let i=s.forwardRef(({className:e,type:r,...t},s)=>(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));i.displayName="Input"},47699:(e,r,t)=>{"use strict";t.d(r,{J:()=>d});var a=t(45512),s=t(58009),n=t(92405),i=t(21643),o=t(59462);let l=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef(({className:e,...r},t)=>(0,a.jsx)(n.b,{ref:t,className:(0,o.cn)(l(),e),...r}));d.displayName=n.b.displayName},59462:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var a=t(82281),s=t(94805);function n(...e){return(0,s.QP)((0,a.$)(e))}},5916:(e,r,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.d(r,{Ht:()=>h,Kd:()=>y,Lz:()=>w,RX:()=>g,VM:()=>v,zP:()=>b});var s=t(21590);t(70376);var n=t(75190),i=t(42385),o=t(99184),l=t(47735),d=t(8805),c=t.n(d),u=t(41231),p=t(13194),m=t(99344),f=e([n]);n=(f.then?(await f)():f)[0];let N=new TextEncoder().encode(process.env.SESSION_SECRET||"local-dev-secret-change-in-production");async function x(e,r){return await new u.P({sub:e,email:r}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(N)}async function b(e){try{return(await (0,p.V)(e,N)).payload}catch(e){return null}}async function h(){let e=await (0,i.UL)(),r=e.get("session")?.value;if(!r)return null;let t=await b(r);if(!t)return null;let a=await (0,n.KU)();try{await a.query(`SET LOCAL app.current_user_id = '${t.sub}'`);let e=await a.query(`SELECT u.id, u.email, p.tenant_id, p.role, p.full_name, p.is_active
       FROM users u
       JOIN profiles p ON u.id = p.id
       WHERE u.id = $1`,[t.sub]);if(0===e.rows.length)return null;return{user:e.rows[0],userId:t.sub,email:t.email}}finally{a.release()}}async function g(e){let r=await (0,n.KU)();try{if(await r.query("BEGIN"),(await r.query("SELECT id FROM users WHERE email = $1",[e.email])).rows.length>0)return{error:"User with this email already exists"};let t=await c().hash(e.password,10),a=(await r.query(`INSERT INTO users (email, encrypted_password, email_confirmed_at)
       VALUES ($1, $2, NOW())
       RETURNING id`,[e.email,t])).rows[0].id,s=null;if(e.inviteToken)return{error:"Invite functionality not yet implemented"};let n=e.organizationName.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");s=(await r.query(`INSERT INTO tenants (name, slug, is_active)
       VALUES ($1, $2, true)
       RETURNING id`,[`${e.organizationName}`,`${n}-${Date.now()}`])).rows[0].id,await r.query(`INSERT INTO profiles (id, tenant_id, role, full_name, is_active)
       VALUES ($1, $2, $3, $4, true)`,[a,s,"Tenant Admin",e.fullName]),await r.query("COMMIT");let o=await x(a,e.email);return(await (0,i.UL)()).set("session",o,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"}),(0,l.revalidatePath)("/","layout"),{success:!0}}catch(e){return await r.query("ROLLBACK"),console.error("Signup error:",e),{error:e.message||"An unexpected error occurred during signup"}}finally{r.release()}}async function w(e){let r=await (0,n.KU)();try{let t=await r.query(`SELECT u.id, u.email, u.encrypted_password, p.tenant_id, p.role, p.is_active
       FROM users u
       JOIN profiles p ON u.id = p.id
       WHERE u.email = $1`,[e.email]);if(0===t.rows.length)return{error:"Invalid email or password"};let a=t.rows[0];if(!await c().compare(e.password,a.encrypted_password))return{error:"Invalid email or password"};if(!a.is_active)return{error:"Your account has been deactivated. Please contact your administrator."};let s=await x(a.id,a.email);return(await (0,i.UL)()).set("session",s,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"}),(0,l.revalidatePath)("/","layout"),{success:!0}}catch(e){return console.error("Signin error:",e),{error:"An unexpected error occurred during signin"}}finally{r.release()}}async function y(){(await (0,i.UL)()).delete("session"),(0,l.revalidatePath)("/","layout"),(0,o.redirect)("/login")}async function v(){let e=await h();if(!e)return null;let r=await (0,n.KU)();try{await r.query(`SET LOCAL app.current_user_id = '${e.userId}'`);let t=await r.query(`SELECT p.*, t.name as tenant_name, t.slug as tenant_slug
       FROM profiles p
       JOIN tenants t ON p.tenant_id = t.id
       WHERE p.id = $1`,[e.userId]);if(0===t.rows.length)return null;return{...t.rows[0],tenant:{id:t.rows[0].tenant_id,name:t.rows[0].tenant_name,slug:t.rows[0].tenant_slug}}}finally{r.release()}}(0,m.D)([b,h,g,w,y,v]),(0,s.A)(b,"40982a859ec3c46a1b6607285e686490468d9e8108",null),(0,s.A)(h,"009a4985819b97b4be2fe1cdb32c9df11877379ad4",null),(0,s.A)(g,"40bd541fc16e4b03c33c1297531f2e89d59c364b4e",null),(0,s.A)(w,"404277a33f7cb0ce1f7247add59deea9a766c2d7db",null),(0,s.A)(y,"007c7f942aadb8dbc8cc2b6b30f60982431f70127f",null),(0,s.A)(v,"0004aa8566c1f3e312cb7f3e3813d6157b8fb58a8b",null),a()}catch(e){a(e)}})},19611:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o,metadata:()=>i});var a=t(62740),s=t(59258),n=t.n(s);t(82704);let i={title:"Customer Success Platform",description:"Multi-tenant Customer Success Platform with RLS"};function o({children:e}){return(0,a.jsx)("html",{lang:"en",children:(0,a.jsx)("body",{className:n().className,children:e})})}},43642:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Volumes/Extreme SSD/Aro Desk/app/login/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Volumes/Extreme SSD/Aro Desk/app/login/page.tsx","default")},75190:(e,r,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.d(r,{KU:()=>o,P:()=>i});var s=t(64939),n=e([s]);let l=new(s=(n.then?(await n)():n)[0]).Pool({connectionString:process.env.DATABASE_URL,max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3});async function i(e,r){let t=Date.now();try{let a=await l.query(e,r),s=Date.now()-t;return console.log("Executed query",{text:e,duration:s,rows:a.rowCount}),a}catch(e){throw console.error("Database query error:",e),e}}async function o(){return l.connect()}a()}catch(e){a(e)}})},82704:()=>{}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,720,145,101,188],()=>t(9175));module.exports=a})();